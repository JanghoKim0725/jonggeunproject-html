<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.myhome.mapper.JonggeunMapper">

	<!-- 주문/배송 조회목록 출력 + 검색기능추가 -->
	<select id="selectOrdlList" parameterType="UproductDto" resultType="Map">
		SELECT PRODUCT_NAME,PRODUCT_PRICE,PRODUCT_DESCRIPTION,PRODUCT_IMG,SALES_CNT FROM PRODUCT
		<where>
			<if test="keyword != null and keyword != ''">
				AND PRODUCT_DESCRIPTION LIKE '%' || #{keyword} || '%'
	        </if>
    	</where>
	</select>
	
	<!-- 주문/배송 조회목록 출력 + 검색기능추가 + 결제완료순 -->
	<select id="selectOrdlListPay2" parameterType="UproductDto" resultType="Map">
		SELECT PR.PRODUCT_NAME,
			   PR.PRODUCT_PRICE,
			   PR.PRODUCT_DESCRIPTION,
			   PR.PRODUCT_IMG,
			   PR.SALES_CNT,
			   PM.PAY_DATE FROM PRODUCT PR JOIN PAYMENT PM ON PR.PRODUCT_NO = PM.PRODUCT_NO
		<where>
			<if test="keyword != null and keyword != ''">
				AND PR.PRODUCT_DESCRIPTION LIKE '%' || #{keyword} || '%'
	        </if>
    	</where> ORDER BY PM.PAY_DATE DESC 
	</select>
	
	<!-- 주문/배송 조회목록 출력 + 검색기능추가 + 배송(주문)완료순 -->
	<select id="selectOrdlListDvr2" parameterType="UproductDto" resultType="Map">
		SELECT PR.PRODUCT_NAME,
			   PR.PRODUCT_PRICE,
			   PR.PRODUCT_DESCRIPTION,
			   PR.PRODUCT_IMG,
			   PR.SALES_CNT,
			   OD.ORDER_RDATE FROM PRODUCT PR JOIN ORDERITEM OD ON PR.PRODUCT_NO = OD.PRODUCT_NO
		<where>
			<if test="keyword != null and keyword != ''">
				AND PR.PRODUCT_DESCRIPTION LIKE '%' || #{keyword} || '%'
	        </if>
    	</where> ORDER BY OD.ORDER_RDATE DESC 
	</select>
	
	<!-- 페이징 출력조건 데이터 개수 (출력항목 개수) -->
	<select id="selectDatatotal"    resultType="int">SELECT COUNT(*) FROM PRODUCT</select>
	
	<!-- 결제완료 여부 -->
	<select id="selectOrdlListPay1" resultType="int">SELECT COUNT(PAY_STATUS)   FROM   PAYMENT</select>
	
	<!-- 배송(주문)완료 여부 -->
	<select id="selectOrdlListDvr1" resultType="int">SELECT COUNT(ORDER_STATUS) FROM ORDERITEM</select>

</mapper>